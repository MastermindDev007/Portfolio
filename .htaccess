############################################
# APACHE CONFIG â€“ DEV SAFE (WAMP)
############################################

# Disable directory listing
Options -Indexes

############################################
# REWRITE ENGINE
############################################
<IfModule mod_rewrite.c>
    RewriteEngine On

    # Remove trailing slash (SEO clean)
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.+)/$ $1 [R=301,L]

    # Remove .php extension
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}.php -f
    RewriteRule ^(.+)$ $1.php [L]

    # Front controller fallback
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^ index.php [L,QSA]
</IfModule>

############################################
# SECURITY HEADERS (SAFE ON WAMP)
############################################
<IfModule mod_headers.c>
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header unset X-Powered-By
</IfModule>

############################################
# COMPRESSION
############################################
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE \
        text/html text/plain text/css \
        application/javascript application/json
</IfModule>

############################################
# CACHE CONTROL
############################################
<IfModule mod_expires.c>
    ExpiresActive On

    ExpiresByType image/jpg  "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png  "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"

    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
</IfModule>

############################################
# PROTECT SENSITIVE FILES (APACHE 2.4 WAY)
############################################
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|sql|json)$">
    Require all denied
</FilesMatch>

############################################
# ERROR HANDLING
############################################
ErrorDocument 404 /index.php
ErrorDocument 403 /index.php
ErrorDocument 500 /index.php
